<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Реалізація інформаційного та програмного забезпечення | Система аналізу медіа-контенту</title>
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="icon" href="/Media-content-analysis-system_db_labs/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <meta name="description" content="Лабораторні роботи з дисципліни &quot;Організація баз даних&quot;">
    
    <link rel="preload" href="/Media-content-analysis-system_db_labs/assets/css/0.styles.7e9ccdc1.css" as="style"><link rel="preload" href="/Media-content-analysis-system_db_labs/assets/js/app.5291d6c3.js" as="script"><link rel="preload" href="/Media-content-analysis-system_db_labs/assets/js/2.4022fe6a.js" as="script"><link rel="preload" href="/Media-content-analysis-system_db_labs/assets/js/23.63200394.js" as="script"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/10.17bf2be4.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/11.35e1bff2.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/12.5f5c2fb1.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/13.61e55bd5.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/14.ecbfbb22.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/15.ac5c29ce.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/16.1cd55828.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/17.fa6dde20.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/18.27116c72.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/19.4297fb6c.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/20.7734d363.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/21.f182c44b.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/22.d2c8692e.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/24.0a9f59da.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/25.397a5a05.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/26.68347950.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/3.c5efe22d.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/4.090207b8.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/5.e5a1d904.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/6.af368dc0.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/7.598774a2.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/8.106039ac.js"><link rel="prefetch" href="/Media-content-analysis-system_db_labs/assets/js/9.1f2bf201.js">
    <link rel="stylesheet" href="/Media-content-analysis-system_db_labs/assets/css/0.styles.7e9ccdc1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Media-content-analysis-system_db_labs/" class="home-link router-link-active"><!----> <span class="site-name">Система аналізу медіа-контенту</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Media-content-analysis-system_db_labs/" class="nav-link">
  Початок
</a></div> <a href="https://github.com/Dementris/Media-content-analysis-system_db_labs" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Media-content-analysis-system_db_labs/" class="nav-link">
  Початок
</a></div> <a href="https://github.com/Dementris/Media-content-analysis-system_db_labs" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/Media-content-analysis-system_db_labs/intro/" class="sidebar-link">Вступ</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/Media-content-analysis-system_db_labs/requirements/" class="sidebar-heading clickable"><span>Розроблення загальних вимог до системи</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/Media-content-analysis-system_db_labs/use%20cases/" class="sidebar-link">Розроблення вимог до функціональности системи</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/use%20cases/#діаграма-прецедентів" class="sidebar-link">Діаграма прецедентів</a></li><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/use%20cases/#usecases-для-користувача" class="sidebar-link">Usecases для користувача</a></li><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/use%20cases/#usecases-для-адміністратора" class="sidebar-link">Usecases для адміністратора</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/use%20cases/#додати-нове-джерело" class="sidebar-link">Додати нове джерело</a></li><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/use%20cases/#надати-прав" class="sidebar-link">Надати прав</a></li><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/use%20cases/#отримати-статистику" class="sidebar-link">Отримати статистику</a></li><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/use%20cases/#звернутись-до-адміністратора" class="sidebar-link">Звернутись до адміністратора</a></li><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/use%20cases/#авторизація" class="sidebar-link">Авторизація</a></li><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/use%20cases/#пошук-даних" class="sidebar-link">Пошук даних</a></li><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/use%20cases/#створення-нового-облікового-запису" class="sidebar-link">Створення нового облікового запису</a></li></ul></li></ul></li><li><a href="/Media-content-analysis-system_db_labs/design/" class="sidebar-link">Проектування інформаційного забезпечення</a></li><li><a href="/Media-content-analysis-system_db_labs/software/" aria-current="page" class="active sidebar-link">Реалізація інформаційного та програмного забезпечення</a></li><li><a href="/Media-content-analysis-system_db_labs/test/" class="sidebar-link">Тестування працездатності системи</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/test/#додати-нове-джерело" class="sidebar-link">Додати нове джерело</a></li><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/test/#надати-прав" class="sidebar-link">Надати прав</a></li><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/test/#отримати-статистику" class="sidebar-link">Отримати статистику</a></li><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/test/#звернутись-до-адміністратора" class="sidebar-link">Звернутись до адміністратора</a></li><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/test/#авторизація" class="sidebar-link">Авторизація</a></li><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/test/#пошук-даних" class="sidebar-link">Пошук даних</a></li><li class="sidebar-sub-header"><a href="/Media-content-analysis-system_db_labs/test/#створення-нового-облікового-запису" class="sidebar-link">Створення нового облікового запису</a></li></ul></li><li><a href="/Media-content-analysis-system_db_labs/conclusion/" class="sidebar-link">Висновки</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="реалізація-інформаціиного-та-програмного-забезпечення"><a href="#реалізація-інформаціиного-та-програмного-забезпечення" class="header-anchor">#</a> Реалізація інформаційного та програмного забезпечення</h1> <p>В рамках проекту розробляється:</p> <ul><li>SQL-скрипт для створення на початкового наповнення бази даних</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- MySQL Script generated by MySQL Workbench</span>
<span class="token comment">-- Sun May 28 00:10:09 2023</span>
<span class="token comment">-- Model: New Model    Version: 1.0</span>
<span class="token comment">-- MySQL Workbench Forward Engineering</span>

<span class="token keyword">SET</span> <span class="token variable">@OLD_UNIQUE_CHECKS</span><span class="token operator">=</span>@<span class="token variable">@UNIQUE_CHECKS</span><span class="token punctuation">,</span> UNIQUE_CHECKS<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@OLD_FOREIGN_KEY_CHECKS</span><span class="token operator">=</span>@<span class="token variable">@FOREIGN_KEY_CHECKS</span><span class="token punctuation">,</span> FOREIGN_KEY_CHECKS<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@OLD_SQL_MODE</span><span class="token operator">=</span>@<span class="token variable">@SQL_MODE</span><span class="token punctuation">,</span> SQL_MODE<span class="token operator">=</span><span class="token string">'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION'</span><span class="token punctuation">;</span>

<span class="token comment">-- -----------------------------------------------------</span>
<span class="token comment">-- Schema mediacontent</span>
<span class="token comment">-- -----------------------------------------------------</span>
<span class="token keyword">DROP</span> <span class="token keyword">SCHEMA</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>mediacontent<span class="token punctuation">`</span></span> <span class="token punctuation">;</span>

<span class="token comment">-- -----------------------------------------------------</span>
<span class="token comment">-- Schema mediacontent</span>
<span class="token comment">-- -----------------------------------------------------</span>
<span class="token keyword">CREATE</span> <span class="token keyword">SCHEMA</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>mediacontent<span class="token punctuation">`</span></span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token punctuation">;</span>
<span class="token keyword">USE</span> <span class="token identifier"><span class="token punctuation">`</span>mediacontent<span class="token punctuation">`</span></span> <span class="token punctuation">;</span>

<span class="token comment">-- -----------------------------------------------------</span>
<span class="token comment">-- Table `mediacontent`.`users`</span>
<span class="token comment">-- -----------------------------------------------------</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>mediacontent<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>users<span class="token punctuation">`</span></span> <span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>mediacontent<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>users<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>email<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>role<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span><span class="token punctuation">;</span>

<span class="token comment">-- -----------------------------------------------------</span>
<span class="token comment">-- Table `mediacontent`.`help`</span>
<span class="token comment">-- -----------------------------------------------------</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>mediacontent<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>help<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>question<span class="token punctuation">`</span></span> <span class="token keyword">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>answer<span class="token punctuation">`</span></span> <span class="token keyword">TEXT</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span> <span class="token keyword">enum</span><span class="token punctuation">(</span><span class="token string">'unresolved'</span><span class="token punctuation">,</span> <span class="token string">'resolved'</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'unresolved'</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
  <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span><span class="token punctuation">;</span>

<span class="token comment">-- -----------------------------------------------------</span>
<span class="token comment">-- Table `mediacontent`.`statistics`</span>
<span class="token comment">-- -----------------------------------------------------</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>mediacontent<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>statistics<span class="token punctuation">`</span></span> <span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>mediacontent<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>statistics<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">INT</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>media_count<span class="token punctuation">`</span></span> <span class="token keyword">INT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>last_login<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span><span class="token punctuation">;</span>


<span class="token comment">-- -----------------------------------------------------</span>
<span class="token comment">-- Table `mediacontent`.`content`</span>
<span class="token comment">-- -----------------------------------------------------</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>mediacontent<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>content<span class="token punctuation">`</span></span> <span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>mediacontent<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>content<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">INT</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>title<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>description<span class="token punctuation">`</span></span> <span class="token keyword">TEXT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>markers<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>url<span class="token punctuation">`</span></span> <span class="token keyword">LONGTEXT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span><span class="token punctuation">;</span>


<span class="token comment">-- -----------------------------------------------------</span>
<span class="token comment">-- Table `mediacontent`.`marker`</span>
<span class="token comment">-- -----------------------------------------------------</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>mediacontent<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>marker<span class="token punctuation">`</span></span> <span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>mediacontent<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>marker<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">INT</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token keyword">User</span><span class="token punctuation">,</span> Host <span class="token keyword">FROM</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span><span class="token punctuation">;</span>


<span class="token keyword">SET</span> SQL_MODE<span class="token operator">=</span><span class="token variable">@OLD_SQL_MODE</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> FOREIGN_KEY_CHECKS<span class="token operator">=</span><span class="token variable">@OLD_FOREIGN_KEY_CHECKS</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> UNIQUE_CHECKS<span class="token operator">=</span><span class="token variable">@OLD_UNIQUE_CHECKS</span><span class="token punctuation">;</span>

</code></pre></div><ul><li>RESTfull сервіс для управління даними
<strong>main.py</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> config
<span class="token keyword">import</span> fastapi
<span class="token keyword">from</span> fastapi <span class="token keyword">import</span> FastAPI<span class="token punctuation">,</span> Request
<span class="token keyword">from</span> fastapi<span class="token punctuation">.</span>responses <span class="token keyword">import</span> JSONResponse
<span class="token keyword">import</span> pymysql
<span class="token keyword">import</span> datetime

app <span class="token operator">=</span> FastAPI<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">DataBase</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    user <span class="token operator">=</span> config<span class="token punctuation">.</span>user
    password <span class="token operator">=</span> config<span class="token punctuation">.</span>password

    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token string">'instance'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            cls<span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token builtin">super</span><span class="token punctuation">(</span>DataBase<span class="token punctuation">,</span> cls<span class="token punctuation">)</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>cls<span class="token punctuation">)</span>
        <span class="token keyword">return</span> cls<span class="token punctuation">.</span>instance
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>connection <span class="token operator">=</span> <span class="token boolean">None</span>
        self<span class="token punctuation">.</span>cursor <span class="token operator">=</span> <span class="token boolean">None</span>
        self<span class="token punctuation">.</span>__connect<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">__connect</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>connection <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>  
        host<span class="token operator">=</span>config<span class="token punctuation">.</span>host<span class="token punctuation">,</span>
        port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>
        user<span class="token operator">=</span>self<span class="token punctuation">.</span>user<span class="token punctuation">,</span>
        password<span class="token operator">=</span>self<span class="token punctuation">.</span>password<span class="token punctuation">,</span>
        database<span class="token operator">=</span>config<span class="token punctuation">.</span>db_name
        <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span>pymysql<span class="token punctuation">.</span>cursors<span class="token punctuation">.</span>DictCursor<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">execute</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> command<span class="token punctuation">)</span><span class="token punctuation">:</span> 
        self<span class="token punctuation">.</span>cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>command<span class="token punctuation">)</span> 
        result <span class="token operator">=</span> self<span class="token punctuation">.</span>cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>connection<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span> 
        <span class="token keyword">return</span> result

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/users&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_users</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token keyword">return</span> JSONResponse<span class="token punctuation">(</span>db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'SELECT * FROM users'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">'/api/user/{id}'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_user_by_id</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    result <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'SELECT * FROM users WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span> 
    <span class="token keyword">if</span> <span class="token keyword">not</span> result<span class="token punctuation">:</span> 
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> JSONResponse<span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/questions&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_questions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token keyword">return</span> JSONResponse<span class="token punctuation">(</span>db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'SELECT * FROM help'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">'/api/question/{id}'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_question_by_id</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    result <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'SELECT * FROM help WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span> 
    <span class="token keyword">if</span> <span class="token keyword">not</span> result<span class="token punctuation">:</span> 
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> JSONResponse<span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/contents&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_questions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token keyword">return</span> JSONResponse<span class="token punctuation">(</span>db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'SELECT * FROM content'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">'/api/content/{id}'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_question_by_id</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    result <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'SELECT * FROM content WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span> 
    <span class="token keyword">if</span> <span class="token keyword">not</span> result<span class="token punctuation">:</span> 
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> JSONResponse<span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/markers&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_questions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token keyword">return</span> JSONResponse<span class="token punctuation">(</span>db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'SELECT * FROM marker'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">'/api/marker/{id}'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_question_by_id</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    result <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'SELECT * FROM marker WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span> 
    <span class="token keyword">if</span> <span class="token keyword">not</span> result<span class="token punctuation">:</span> 
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> JSONResponse<span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/stats&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_stats</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        result <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'SELECT * FROM statistics'</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> pymysql<span class="token punctuation">.</span>err<span class="token punctuation">.</span>OperationalError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;Error getting statistics: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> JSONResponse<span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">'/api/stat/{id}'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_stat_by_id</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        result <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'SELECT * FROM statistics WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span> 
    <span class="token keyword">except</span> pymysql<span class="token punctuation">.</span>err<span class="token punctuation">.</span>OperationalError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;Error getting statistics: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
  
    <span class="token keyword">if</span> <span class="token keyword">not</span> result<span class="token punctuation">:</span> 
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> JSONResponse<span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>patch</span><span class="token punctuation">(</span><span class="token string">'/api/user/{id}'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">set_connect_data</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        new_user <span class="token operator">=</span> config<span class="token punctuation">.</span>user
        new_password <span class="token operator">=</span> config<span class="token punctuation">.</span>password
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'SELECT * FROM users WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">)</span>

        new_password <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;SELECT password FROM users WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">;&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">]</span>

        <span class="token keyword">if</span> <span class="token keyword">not</span> new_password<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">)</span>
        
        new_user <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;User(</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">)&quot;</span></span>

    DataBase<span class="token punctuation">.</span>user <span class="token operator">=</span> new_user 
    DataBase<span class="token punctuation">.</span>password <span class="token operator">=</span> new_password 

    media_count <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&quot;SELECT COUNT(*) FROM content&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;COUNT(*)&quot;</span><span class="token punctuation">]</span>

    current_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
    current_time_str <span class="token operator">=</span> current_time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span>

    db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;INSERT INTO `statistics`(`user`, `media_count`, `last_login`) &quot;</span></span> 
    <span class="token string-interpolation"><span class="token string">f&quot;VALUES ('</span><span class="token interpolation"><span class="token punctuation">{</span>new_user<span class="token punctuation">}</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">{</span>media_count<span class="token punctuation">}</span></span><span class="token string">', '</span><span class="token interpolation"><span class="token punctuation">{</span>current_time_str<span class="token punctuation">}</span></span><span class="token string">');&quot;</span></span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> JSONResponse<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'message'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f&quot;Connected as </span><span class="token interpolation"><span class="token punctuation">{</span>DataBase<span class="token punctuation">.</span>user<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">'/api/user'</span><span class="token punctuation">,</span> status_code<span class="token operator">=</span><span class="token number">201</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">add_new_user</span><span class="token punctuation">(</span>req<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    req_dict <span class="token operator">=</span> <span class="token keyword">await</span> req<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        name <span class="token operator">=</span> req_dict<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
        password <span class="token operator">=</span> req_dict<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span> 
        email <span class="token operator">=</span> req_dict<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span> 
        role <span class="token operator">=</span> req_dict<span class="token punctuation">[</span><span class="token string">'role'</span><span class="token punctuation">]</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>     
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">)</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>

    existing_user <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;SELECT * FROM `users` WHERE `email` = '</span><span class="token interpolation"><span class="token punctuation">{</span>email<span class="token punctuation">}</span></span><span class="token string">'&quot;</span></span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> existing_user<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">409</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string">'User with the same email already exists.'</span><span class="token punctuation">)</span>
    
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;INSERT INTO `users`(`name`, `password`, `email`, `role`) &quot;</span></span> 
        <span class="token string-interpolation"><span class="token string">f&quot;VALUES ('</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">{</span>password<span class="token punctuation">}</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">{</span>email<span class="token punctuation">}</span></span><span class="token string">',</span><span class="token interpolation"><span class="token punctuation">{</span>role<span class="token punctuation">}</span></span><span class="token string">);&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> pymysql<span class="token punctuation">.</span>err<span class="token punctuation">.</span>OperationalError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;Error adding users data: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    
    <span class="token builtin">id</span> <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;SELECT id FROM users WHERE email='</span><span class="token interpolation"><span class="token punctuation">{</span>email<span class="token punctuation">}</span></span><span class="token string">';&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span>
    db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;CREATE USER 'User(</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">)'@'localhost' IDENTIFIED BY '</span><span class="token interpolation"><span class="token punctuation">{</span>password<span class="token punctuation">}</span></span><span class="token string">';&quot;</span></span><span class="token punctuation">)</span>
    setRole<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span> role<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">'message'</span><span class="token punctuation">:</span><span class="token string">'New user added!'</span><span class="token punctuation">}</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">'/api/question'</span><span class="token punctuation">,</span> status_code<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">add_question</span><span class="token punctuation">(</span>req<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    req_dict <span class="token operator">=</span> <span class="token keyword">await</span> req<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        question <span class="token operator">=</span> req_dict<span class="token punctuation">[</span><span class="token string">'question'</span><span class="token punctuation">]</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>     
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">)</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;INSERT INTO `help`(`question`) VALUES ('</span><span class="token interpolation"><span class="token punctuation">{</span>question<span class="token punctuation">}</span></span><span class="token string">');&quot;</span></span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">'message'</span><span class="token punctuation">:</span><span class="token string">'New question added!'</span><span class="token punctuation">}</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">'/api/content'</span><span class="token punctuation">,</span> status_code<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">add_content</span><span class="token punctuation">(</span>req<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    req_dict <span class="token operator">=</span> <span class="token keyword">await</span> req<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        title <span class="token operator">=</span> req_dict<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span>
        description <span class="token operator">=</span> req_dict<span class="token punctuation">[</span><span class="token string">'description'</span><span class="token punctuation">]</span> 
        markers <span class="token operator">=</span> req_dict<span class="token punctuation">[</span><span class="token string">'markers'</span><span class="token punctuation">]</span> 
        url <span class="token operator">=</span> req_dict<span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>     
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">)</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    existing_url <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;SELECT * FROM `content` WHERE `url` = '</span><span class="token interpolation"><span class="token punctuation">{</span>url<span class="token punctuation">}</span></span><span class="token string">'&quot;</span></span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> existing_url<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">409</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string">'Content with the same url already exists.'</span><span class="token punctuation">)</span>

    table_markers <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'SELECT * FROM marker'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> table_markers<span class="token punctuation">:</span>
        <span class="token keyword">for</span> marker <span class="token keyword">in</span> table_markers<span class="token punctuation">:</span>
            marker_name <span class="token operator">=</span> marker<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
            markers <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f&quot;, </span><span class="token interpolation"><span class="token punctuation">{</span>marker_name<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>
            
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;INSERT INTO `content`(`title`, `description`, `markers`, `url`) &quot;</span></span> 
        <span class="token string-interpolation"><span class="token string">f&quot;VALUES ('</span><span class="token interpolation"><span class="token punctuation">{</span>title<span class="token punctuation">}</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">{</span>description<span class="token punctuation">}</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">{</span>markers<span class="token punctuation">}</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">{</span>url<span class="token punctuation">}</span></span><span class="token string">');&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> pymysql<span class="token punctuation">.</span>err<span class="token punctuation">.</span>OperationalError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;Error adding content data: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">'message'</span><span class="token punctuation">:</span><span class="token string">'New content added!'</span><span class="token punctuation">}</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">'/api/marker'</span><span class="token punctuation">,</span> status_code<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">add_marker</span><span class="token punctuation">(</span>req<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    req_dict <span class="token operator">=</span> <span class="token keyword">await</span> req<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        name <span class="token operator">=</span> req_dict<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>     
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">)</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    existing_name <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;SELECT * FROM `marker` WHERE `name` = '</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">'&quot;</span></span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> existing_name<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">409</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string">'Marker with the same name already exists.'</span><span class="token punctuation">)</span>

    <span class="token keyword">try</span><span class="token punctuation">:</span>
        db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;INSERT INTO `marker`(`name`) VALUES ('</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">');&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> pymysql<span class="token punctuation">.</span>err<span class="token punctuation">.</span>OperationalError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;Error adding marker: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    contents <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&quot;SELECT * FROM `content`;&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> contents<span class="token punctuation">:</span>
        <span class="token keyword">for</span> content <span class="token keyword">in</span> contents<span class="token punctuation">:</span>
            markers <span class="token operator">=</span> content<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'markers'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
            markers <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f&quot;, </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>
            db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;UPDATE `content` SET `markers` = '</span><span class="token interpolation"><span class="token punctuation">{</span>markers<span class="token punctuation">}</span></span><span class="token string">' WHERE `id` = </span><span class="token interpolation"><span class="token punctuation">{</span>content<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">;&quot;</span></span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">'message'</span><span class="token punctuation">:</span><span class="token string">'New marker added!'</span><span class="token punctuation">}</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>put</span><span class="token punctuation">(</span><span class="token string">'/api/user/{id}'</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">update_user</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span> req<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    req_dict <span class="token operator">=</span> <span class="token keyword">await</span> req<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span> 
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> key <span class="token keyword">in</span> req_dict<span class="token punctuation">:</span>  
        <span class="token keyword">if</span> <span class="token keyword">not</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'SELECT * FROM users WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> key <span class="token operator">==</span> <span class="token string">&quot;role&quot;</span><span class="token punctuation">:</span>
                db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;REVOKE ALL PRIVILEGES ON *.* FROM 'User(</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">)'@'localhost';&quot;</span></span><span class="token punctuation">)</span>
                setRole<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span> req_dict<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
            db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'UPDATE users SET </span><span class="token interpolation"><span class="token punctuation">{</span>key<span class="token punctuation">}</span></span><span class="token string">=&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>req_dict<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot; WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> pymysql<span class="token punctuation">.</span>err<span class="token punctuation">.</span>OperationalError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;Error updating user data: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">:</span><span class="token string">'Updated!'</span><span class="token punctuation">}</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>put</span><span class="token punctuation">(</span><span class="token string">'/api/answer/{id}'</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">update_answer</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span> req<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    req_dict <span class="token operator">=</span> <span class="token keyword">await</span> req<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span> 
    answer <span class="token operator">=</span> req_dict<span class="token punctuation">[</span><span class="token string">&quot;answer&quot;</span><span class="token punctuation">]</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token keyword">not</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'SELECT * FROM help WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'UPDATE help SET answer=&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>answer<span class="token punctuation">}</span></span><span class="token string">&quot; WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> pymysql<span class="token punctuation">.</span>err<span class="token punctuation">.</span>OperationalError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;Error updating answer: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'UPDATE help SET status=&quot;resolved&quot; WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">:</span><span class="token string">'Answer updated!'</span><span class="token punctuation">}</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>put</span><span class="token punctuation">(</span><span class="token string">'/api/content/{id}'</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">update_content</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span> req<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    req_dict <span class="token operator">=</span> <span class="token keyword">await</span> req<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span> 
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> key <span class="token keyword">in</span> req_dict<span class="token punctuation">:</span>  
        <span class="token keyword">if</span> <span class="token keyword">not</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'SELECT * FROM content WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
           db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'UPDATE content SET </span><span class="token interpolation"><span class="token punctuation">{</span>key<span class="token punctuation">}</span></span><span class="token string">=&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>req_dict<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot; WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> pymysql<span class="token punctuation">.</span>err<span class="token punctuation">.</span>OperationalError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;Error updating content data: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">:</span><span class="token string">'Updated!'</span><span class="token punctuation">}</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>put</span><span class="token punctuation">(</span><span class="token string">'/api/marker/{id}'</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">update_content</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span> req<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    req_dict <span class="token operator">=</span> <span class="token keyword">await</span> req<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span> 
    name <span class="token operator">=</span> req_dict<span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'SELECT * FROM marker WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        contents <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&quot;SELECT * FROM `content`&quot;</span><span class="token punctuation">)</span>
        old_marker <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'SELECT name FROM marker WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span>

        <span class="token keyword">for</span> content <span class="token keyword">in</span> contents<span class="token punctuation">:</span>
            markers <span class="token operator">=</span> content<span class="token punctuation">[</span><span class="token string">'markers'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
            new_markers <span class="token operator">=</span> <span class="token punctuation">[</span>marker<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>old_marker<span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token keyword">if</span> marker<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> old_marker<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> marker <span class="token keyword">for</span> marker <span class="token keyword">in</span> markers<span class="token punctuation">]</span>
            new_markers_str <span class="token operator">=</span> <span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>new_markers<span class="token punctuation">)</span>
            db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'UPDATE content SET markers=&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>new_markers_str<span class="token punctuation">}</span></span><span class="token string">&quot; WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span>content<span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

        db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'UPDATE marker SET name=&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">&quot; WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> pymysql<span class="token punctuation">.</span>err<span class="token punctuation">.</span>OperationalError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;Error updating marker: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">:</span><span class="token string">'Updated!'</span><span class="token punctuation">}</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>delete</span><span class="token punctuation">(</span><span class="token string">'/api/user/{id}'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">delete_user</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'SELECT * FROM users WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'DELETE FROM `users` WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> pymysql<span class="token punctuation">.</span>err<span class="token punctuation">.</span>OperationalError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;Error deleting user: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;DROP USER 'User(</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">)'@'localhost';&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">'message'</span><span class="token punctuation">:</span><span class="token string-interpolation"><span class="token string">f'User with id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string"> deleted'</span></span><span class="token punctuation">}</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>delete</span><span class="token punctuation">(</span><span class="token string">'/api/question/{id}'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">delete_question</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'SELECT * FROM help WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'DELETE FROM `help` WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> pymysql<span class="token punctuation">.</span>err<span class="token punctuation">.</span>OperationalError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;Error deleting question: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">'message'</span><span class="token punctuation">:</span><span class="token string-interpolation"><span class="token string">f'Question with id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string"> deleted'</span></span><span class="token punctuation">}</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>delete</span><span class="token punctuation">(</span><span class="token string">'/api/content/{id}'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">delete_content</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'SELECT * FROM content WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'DELETE FROM `content` WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> pymysql<span class="token punctuation">.</span>err<span class="token punctuation">.</span>OperationalError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;Error deleting content: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">'message'</span><span class="token punctuation">:</span><span class="token string-interpolation"><span class="token string">f'Content with id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string"> deleted'</span></span><span class="token punctuation">}</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>delete</span><span class="token punctuation">(</span><span class="token string">'/api/marker/{id}'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">delete_marker</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'SELECT * FROM marker WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        contents <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&quot;SELECT * FROM `content`&quot;</span><span class="token punctuation">)</span>
        old_marker <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'SELECT name FROM marker WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span>

        <span class="token keyword">for</span> content <span class="token keyword">in</span> contents<span class="token punctuation">:</span>
            markers <span class="token operator">=</span> content<span class="token punctuation">[</span><span class="token string">'markers'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
            new_markers <span class="token operator">=</span> <span class="token punctuation">[</span>marker <span class="token keyword">for</span> marker <span class="token keyword">in</span> markers <span class="token keyword">if</span> marker<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> old_marker<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
            new_markers_str <span class="token operator">=</span> <span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>new_markers<span class="token punctuation">)</span>
            db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'UPDATE content SET markers=&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>new_markers_str<span class="token punctuation">}</span></span><span class="token string">&quot; WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span>content<span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

        db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'DELETE FROM `marker` WHERE id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> pymysql<span class="token punctuation">.</span>err<span class="token punctuation">.</span>OperationalError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;Error deleting marker: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">'message'</span><span class="token punctuation">:</span><span class="token string-interpolation"><span class="token string">f'Marker with id=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string"> deleted'</span></span><span class="token punctuation">}</span>


<span class="token keyword">def</span> <span class="token function">setRole</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> DataBase<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> value <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;GRANT ALL PRIVILEGES ON *.* TO 'User(</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">)'@'localhost' WITH GRANT OPTION;&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> value <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        tables <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&quot;SHOW TABLES;&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># Получить список всех таблиц в базе данных</span>
        <span class="token keyword">for</span> table <span class="token keyword">in</span> tables<span class="token punctuation">:</span>
            table_name <span class="token operator">=</span> table<span class="token punctuation">[</span><span class="token string">'Tables_in_mediacontent'</span><span class="token punctuation">]</span>
            <span class="token keyword">if</span> table_name <span class="token operator">!=</span> <span class="token string">'statistics'</span><span class="token punctuation">:</span>  <span class="token comment"># Пропустить таблицу, на которую не нужно давать доступ</span>
                db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;GRANT SELECT ON `mediacontent`.`</span><span class="token interpolation"><span class="token punctuation">{</span>table_name<span class="token punctuation">}</span></span><span class="token string">` TO 'User(</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">)'@'localhost';&quot;</span></span><span class="token punctuation">)</span>
        db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;GRANT INSERT ON `mediacontent`.`help` TO 'User(</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">)'@'localhost';&quot;</span></span><span class="token punctuation">)</span>
        db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;GRANT INSERT ON `mediacontent`.`statistics` TO 'User(</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">)'@'localhost';&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> fastapi<span class="token punctuation">.</span>HTTPException<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string">'Incorrect role: Write 0 for administrator or 1 for ordinary user'</span><span class="token punctuation">)</span>

</code></pre></div><p><strong>config.py</strong></p> <div class="language-python extra-class"><pre class="language-python"><code>host <span class="token operator">=</span> <span class="token string">&quot;127.0.0.1&quot;</span>
user <span class="token operator">=</span> <span class="token string">&quot;root&quot;</span>
password <span class="token operator">=</span> <span class="token string">&quot;12345678&quot;</span>
db_name <span class="token operator">=</span> <span class="token string">&quot;mediacontent&quot;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Останнє оновлення:</span> <span class="time">6/5/2023, 4:20:53 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Media-content-analysis-system_db_labs/design/" class="prev">
        Проектування інформаційного забезпечення
      </a></span> <span class="next"><a href="/Media-content-analysis-system_db_labs/test/">
        Тестування працездатності системи
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/Media-content-analysis-system_db_labs/assets/js/app.5291d6c3.js" defer></script><script src="/Media-content-analysis-system_db_labs/assets/js/2.4022fe6a.js" defer></script><script src="/Media-content-analysis-system_db_labs/assets/js/23.63200394.js" defer></script>
  </body>
</html>
